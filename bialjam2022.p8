pico-8 cartridge // http://www.pico-8.com
version 36
__lua__
-- main

function _init()
 startgame()
end

function _update()
	if mode=="game" then
		update_game()
	end
end

function _draw()
 if mode=="game" then
 	draw_game()
 end
end

function startgame()
 mode="game" 
	
	player={
	 track=1,
	 shape=2,
	 _x=-1,
	 _y=111,
	}
	
	bgstrips={}
	for i=-8,127,8 do
		add(bgstrips,{y=i})
	end
end
-->8
-- draw

function draw_game()
	cls(2)
	draw_background()
	draw_player()
end

function draw_background()
	-- draw tracks
	rectfill(20,0,43,127,15)
	rectfill(52,0,75,127,15)
	rectfill(84,0,107,127,15)
	
	-- 1-pixel lines
	line(21,0,21,127,2)
	line(42,0,42,127,2)
	
	line(53,0,53,127,2)
	line(74,0,74,127,2)
	
	line(85,0,85,127,2)
	line(106,0,106,127,2)
	
	-- animated strips
	for strip in all(bgstrips) do
		rectfill(47,strip.y,48,strip.y+4,15)
		rectfill(79,strip.y,80,strip.y+4,15)
		 strip.y+=1
		 if strip.y>=128 then
		 	strip.y=-8
   end
	end
end

function draw_player()
	if player.shape==0 then
		_draw_ball()
	elseif player.shape==1 then
	 _draw_rectangle()
	elseif player.shape==2 then
	 _draw_square()
	end
end

function _draw_ball()
 local px=player._x
 local py=player._y
 
 -- shadow
 ovalfill(px-3,py-1,px+4,py+1,5)
 
 -- ball
 ovalfill(px-3,py-7,px+4,py,10)
 oval(px-3,py-7,px+4,py,9)
 
 -- highlight
 rectfill(px+1,py-5,px+2,py-4,7)
end

function _draw_rectangle()
 local px=player._x
 local py=player._y
 
 -- shadow
 rectfill(px-6,py-2,px+7,py+3,5)
 line(px-7,py-1,px-7,py+2)
 line(px+8,py-1,px+8,py+2)
 
 -- rectangle floats
 py-=14
 
 -- rectangle
 rectfill(px-6,py-2,px+7,py+3,11)
 line(px-7,py-2,px-7,py+3,3)
 line(px+8,py-2,px+8,py+3,3)
 line(px-6,py-3,px+7,py-3,3)
 line(px-6,py+4,px+7,py+4,3)
 
 -- highlight
 line(px+4,py-1,px+6,py-1,7)
 pset(px+6,py,7)
 
 -- anti-highlight
 line(px-5,py+2,px-3,py+2,3)
 pset(px-5,py+1,3)
end

function _draw_square()
 local px=player._x
 local py=player._y
 
 -- shadow
 rectfill(px-11,py,px+12,py+3,5)
 line(px-10,py+4,px+11,py+4,5)

 -- square
 rectfill(px-10,py-22,px+11,py-1,12)
 line(px-10,py-23,px+11,py-23,1)
 line(px-10,py,px+11,py,1)
 line(px-11,py-22,px-11,py-1,1)
 line(px+12,py-22,px+12,py-1,1)
end

-->8
-- update

function update_game()
 if btnp(0) then
  player.track-=1
  if player.track<0 then
  	player.track=0
  end
 end
 if btnp(1) then
  player.track+=1
  if player.track>2 then
  	player.track=2
  end
 end

 if player.track==0 then
 	player._x=31
 elseif player.track==1 then
  player._x=63
 elseif player.track==2 then
  player._x=95
 end
end
-->8
-- tools/helpers

__gfx__
22222222222222222222f2ffffffffffffffffffff2f222ff222f2ffffffffffffffffffff2f222ff222f2ffffffffffffffffffff2f22222222222222222222
22222222222222222222f2ffffffffffffffffffff2f222ff222f2ffffffffffffffffffff2f222ff222f2ffffffffffffffffffff2f22222222222222222222
22222222222222222222f2ffffffffffffffffffff2f22222222f2ffffffffffffffffffff2f22222222f2ffffffffffffffffffff2f22222222222222222222
22222222222222222222f2ffffffffffffffffffff2f22222222f2ffffffffffffffffffff2f22222222f2ffffffffffffffffffff2f22222222222222222222
22222222222222222222f2ffffffffffffffffffff2f22222222f2ffffffffffffffffffff2f22222222f2ffffffffffffffffffff2f22222222222222222222
22222222222222222222f2ffffffffffffffffffff2f222ff222f2ffffffffffffffffffff2f222ff222f2ffffffffffffffffffff2f22222222222222222222
22222222222222222222f2ffffffffffffffffffff2f222ff222f2ffffffffffffffffffff2f222ff222f2ffffffffffffffffffff2f22222222222222222222
22222222222222222222f2ffffffffffffffffffff2f222ff222f2ffffffffffffffffffff2f222ff222f2ffffffffffffffffffff2f22222222222222222222
22222222222222222222f2ffffffffffffffffffff2f222ff222f2ffffffffffffffffffff2f222ff222f2ffffffffffffffffffff2f22222222222222222222
22222222222222222222f2ffffffffffffffffffff2f222ff222f2ffffffffffffffffffff2f222ff222f2ffffffffffffffffffff2f22222222222222222222
22222222222222222222f2ffffffffffffffffffff2f22222222f2ffffffffffffffffffff2f22222222f2ffffffffffffffffffff2f22222222222222222222
22222222222222222222f2ffffffffffffffffffff2f22222222f2ffffffffffffffffffff2f22222222f2ffffffffffffffffffff2f22222222222222222222
22222222222222222222f2ffffffffffffffffffff2f22222222f2ffffffffffffffffffff2f22222222f2ffffffffffffffffffff2f22222222222222222222
22222222222222222222f2ffffffffffffffffffff2f222ff222f2ffffffffffffffffffff2f222ff222f2ffffffffffffffffffff2f22222222222222222222
22222222222222222222f2ffffffffffffffffffff2f222ff222f2ffffffffffffffffffff2f222ff222f2ffffffffffffffffffff2f22222222222222222222
22222222222222222222f2ffffffffffffffffffff2f222ff222f2ffffffffffffffffffff2f222ff222f2ffffffffffffffffffff2f22222222222222222222
22222222222222222222f2ffffffffffffffffffff2f222ff222f2ffffffffffffffffffff2f222ff222f2ffffffffffffffffffff2f22222222222222222222
22222222222222222222f2ffffffffffffffffffff2f222ff222f2ffffffffffffffffffff2f222ff222f2ffffffffffffffffffff2f22222222222222222222
22222222222222222222f2ffffffffffffffffffff2f22222222f2ffffffffffffffffffff2f22222222f2ffffffffffffffffffff2f22222222222222222222
22222222222222222222f2ffffffffffffffffffff2f22222222f2ffffffffffffffffffff2f22222222f2ffffffffffffffffffff2f22222222222222222222
22222222222222222222f2ffffffffffffffffffff2f22222222f2ffffffffffffffffffff2f22222222f2ffffffffffffffffffff2f22222222222222222222
22222222222222222222f2ffffffffffffffffffff2f222ff222f2ffffffffffffffffffff2f222ff222f2ffffffffffffffffffff2f22222222222222222222
22222222222222222222f2ffffffffffffffffffff2f222ff222f2ffffffffffffffffffff2f222ff222f2ffffffffffffffffffff2f22222222222222222222
22222222222222222222f2ffffffffffffffffffff2f222ff222f2ffffffffffffffffffff2f222ff222f2ffffffffffffffffffff2f22222222222222222222
22222222222222222222f2ffffffffffffffffffff2f222ff222f2ffffffffffffffffffff2f222ff222f2ffffffffffffffffffff2f22222222222222222222
22222222222222222222f2ffffffffffffffffffff2f222ff222f2ffffffffffffffffffff2f222ff222f2ffffffffffffffffffff2f22222222222222222222
22222222222222222222f2ffffffffffffffffffff2f22222222f2ffffffffffffffffffff2f22222222f2ffffffffffffffffffff2f22222222222222222222
22222222222222222222f2ffffffffffffffffffff2f22222222f2ffffffffffffffffffff2f22222222f2ffffffffffffffffffff2f22222222222222222222
22222222222222222222f2ffffffffffffffffffff2f22222222f2ffffffffffffffffffff2f22222222f2ffffffffffffffffffff2f22222222222222222222
22222222222222222222f2ffffffffffffffffffff2f222ff222f2ffffffffffffffffffff2f222ff222f2ffffffffffffffffffff2f22222222222222222222
22222222222222222222f2ffffffffffffffffffff2f222ff222f2ffffffffffffffffffff2f222ff222f2ffffffffffffffffffff2f22222222222222222222
22222222222222222222f2ffffffffffffffffffff2f222ff222f2ffffffffffffffffffff2f222ff222f2ffffffffffffffffffff2f22222222222222222222
22222222222555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555522222222222
22222222225778888887777778888887777778888887777778888887777778888887777788888877777788888877777788888877777788888877752222222222
22222222257778888887777778888887777778888887777778888887777778888887777788888877777788888877777788888877777788888877775222222222
22222222577778888887777778888887777778888887777778888887777778888887777788888877777788888877777788888877777788888877777522222222
22222222577778888887777778888887777778888887777778888887777778888887777788888877777788888877777788888877777788888877777522222222
22222222577778888887777778888887777778888887777778888887777778888887777788888877777788888877777788888877777788888877777522222222
22222222577778888887777778888887777778888887777778888887777778888887777788888877777788888877777788888877777788888877777522222222
22222222577778888887777778888887777778888887777778888887777778888887777788888877777788888877777788888877777788888877777522222222
22222222577778888887777778888887777778888887777778888887777778888887777788888877777788888877777788888877777788888877777522222222
55555555577778888887777778888887777778888887777778888887777778888887777788888877777788888877777788888877777788888877777555555555
77777777577778888887777778888887777778888887777778888887777778888887777788888877777788888877777788888877777788888877777577777777
77777777577778888887777778888887777778888887777778888887777778888887777788888877777788888877777788888877777788888877777577777777
77777777577778888887777778888887777778888887777778888887777778888887777788888877777788888877777788888877777788888877777577777777
66666666577778888887777778888887777778888887777778888887777778888887777788888877777788888877777788888877777788888877777566666666
55555555577778888887777778888887777778888887777778888887777778888887777788888877777758585857575758585857575788888877777555555555
222222225777788888877775555555555555555558877777788888877777788888877777888888777775f5f5f5f5f5f5f5f5f5f5f52558888877777522222222
222222225777788888877775000000000000000058877777788888877777788888877777888888777775f2ffffffffffffffffffff2f58888877777522222222
222222225777788888877775000000000000000058877777788888877777788888877777888888777752f2ffffffffffffffffffff2f25888877777522222222
222222225777788888877775ffffffffffffffff58877777788888877777788888877777888888777775f2ffffffffffffffffffff2f58888877777522222222
222222225777788888877775ffffffffffffffff58877777788888877777788888877777888888777752f2ffffffffffffffffffff2f25888877777522222222
222222225777788888877775ffffffffffffffff58877777788888877777788888877777888888777775f2ffffffffffffffffffff2f58888877777522222222
222222225777788888877775ffffffffffffffff58877777788888877777788888877777888888777752f2ffffffffffffffffffff2f25888877777522222222
222222225777788888877775ffffffffffffffff58877777788888877777788888877777888888777775f2ffffffffffffffffffff2f58888877777522222222
222222225777788888877775666666666666666658877777788888877777788888877777888888777752f2ffffffffffffffffffff2f25888877777522222222
222222225777788888877775555555555555555558877777788888877777788888877777888888777775f2ffffffffffffffffffff2f58888877777522222222
555555555777788888877777788888877777788888877777788888877777788888877777888888777752f2ffffffffffffffffffff2f25888877777555555555
777777775777788888877777788888877777788888877777788888877777788888877777888888777775f2ffffffffffffffffffff2f58888877777577777777
777777775777788888877777788888877777788888877777788888877777788888877777888888777752f2ffffffffffffffffffff2f25888877777577777777
777777775777788888877777788888877777788888877777788888877777788888877777888888777775f2ffffffffffffffffffff2f58888877777577777777
666666665777788888877777788888877777788888877777788888877777788888877777888888777752f2ffffffffffffffffffff2f25888877777566666666
555555555777788888877777788888877777788888877777788888877777788888877777888888777775f2ffffffffffffffffffff2f58888877777555555555
222222225777788888877777788888877777788888877777788888877777785555877777888888777752f2ffffffffffffffffffff2f25888877777522222222
222222225777788888877777788888877777788888877777788888877777750000577777888888777775f2ffffffffffffffffffff2f58888877777522222222
222222225777788888877777788888877777788888877777788888877777500000057777888888777752f2ffffffffffffffffffff2f25888877777522222222
22222222577778888887777778888887777778888887777778888887777750ffff057777888888777775f2ffffffffffffffffffff2f58888877777522222222
22222222577778888887777778888887777778888887777778888887777500ffff005777888888777752f2ffffffffffffffffffff2f25888877777522222222
222222225677788888877777788888877777788888877777788888877775ffffffff5777888888777775f2ffffffffffffffffffff2f58888877776522222222
222222222567788888877777788888877777788888877777788888877775ffffffff5777888888777752f2ffffffffffffffffffff2f25888877765222222222
222222222256644444466666644444466666644444466666644444466665ffffffff5666444444666665f2ffffffffffffffffffff2f54444466652222222222
222222222225555555555555555555555555555555555555555555555555666666665555555555555555f2ffffffffffffffffffff2f55555555522222222222
22222222222222222222f2ffffffffffffffffffff2f222ff222f2ffffffff9999ffffffff2f222ff222f2ffffffffffffffffffff2f22222222222222222222
22222222222222222222f2ffffffffffffffffffff2f222ff222f2fffffff9aaaa9fffffff2f222ff222f2ffffffffffffffffffff2f22222222222222222222
22222222222222222222f2ffffffffffffffffffff2f22222222f2ffffff9aaaaaa9ffffff2f22222222f2ffffffffffffffffffff2f22222222222222222222
22222222222222222222f2ffffffffffffffffffff2f22222222f2ffffff9aaaaaa9ffffff2f22222222f2ffffffffffffffffffff2f22222222222222222222
22222222222222222222f2ffffffffffffffffffff2f22222222f2ffffff9aaaaaa9ffffff2f22222222f2ffffffffffffffffffff2f22222222222222222222
22222222222222222222f2ffffffffffffffffffff2f222ff222f2ffffff9aaaaaa9ffffff2f222ff222f2ffffffffffffffffffff2f22222222222222222222
22222222222222222222f2ffffffffffffffffffff2f222ff222f2fffffff9aaaa9fffffff2f222ff222f2ffffffffffffffffffff2f22222222222222222222
22222222222222222222f2ffffffffffffffffffff2f222ff222f2ffffff55999955ffffff2f222ff222f2ffffffffffffffffffff2f22222222222222222222
22222222222222222222f2fff33333333333333fff2f222ff222f2ffffffff5555ffffffff2f222ff222f2ffffffffffffffffffff2f22222222222222222222
22222222222222222222f2ff3bbbbbbbbbbbbbb3ff2f222ff222f2ffffffffffffffffffff2f222ff222f2ffffffffffffffffffff2f22222222222222222222
22222222222222222222f2ff3bbbbbbbbbbbbbb3ff2f22222222f2ffffffffffffffffffff2f22222222f2ffffffffffffffffffff2f22222222222222222222
22222222222222222222f2ff3bbbbbbbbbbbbbb3ff2f22222222f2ffffffffffffffffffff2f22222222f2ffffffffffffffffffff2f22222222222222222222
22222222222222222222f2ff3bbbbbbbbbbbbbb3ff2f22222222f2ffffffffffffffffffff2f22222222f2ffffffffffffffffffff2f22222222222222222222
22222222222222222222f2ff3bbbbbbbbbbbbbb3ff2f222ff222f2ffffffffffffffffffff2f222ff222f2ffffffffffffffffffff2f22222222222222222222
22222222222222222222f2ff3bbbbbbbbbbbbbb3ff2f222ff222f2ffffffffffffffffffff2f222ff222f2ffffffffffffffffffff2f22222222222222222222
22222222222222222222f2fff33333333333333fff2f222ff222f2ffffffffffffffffffff2f222ff222f2ffffffffffffffffffff2f22222222222222222222
22222222222222222222f2ffffffffffffffffffff2f222ff222f2ffffffffffffffffffff2f222ff222f1111111111111111111111f22222222222222222222
22222222222222222222f2ffffffffffffffffffff2f222ff222f2ffffffffffffffffffff2f222ff2221cccccccccccccccccccccc122222222222222222222
22222222222222222222f2ffffffffffffffffffff2f22222222f2ffffffffffffffffffff2f222222221cccccccccccccccccccccc122222222222222222222
22222222222222222222f2ffffffffffffffffffff2f22222222f2ffffffffffffffffffff2f222222221cccccccccccccccccccccc122222222222222222222
22222222222222222222f2ffffffffffffffffffff2f22222222f2ffffffffffffffffffff2f222222221cccccccccccccccccccccc122222222222222222222
22222222222222222222f2ffffffffffffffffffff2f222ff222f2ffffffffffffffffffff2f222ff2221cccccccccccccccccccccc122222222222222222222
22222222222222222222f2ffffffffffffffffffff2f222ff222f2ffffffffffffffffffff2f222ff2221cccccccccccccccccccccc122222222222222222222
22222222222222222222f2ffffffffffffffffffff2f222ff222f2ffffffffffffffffffff2f222ff2221cccccccccccccccccccccc122222222222222222222
22222222222222222222f2ffffffffffffffffffff2f222ff222f2ffffffffffffffffffff2f222ff2221cccccccccccccccccccccc122222222222222222222
22222222222222222222f2fff55555555555555fff2f222ff222f2ffffffffffffffffffff2f222ff2221cccccccccccccccccccccc122222222222222222222
22222222222222222222f2ff5555555555555555ff2f22222222f2ffffffffffffffffffff2f222222221cccccccccccccccccccccc122222222222222222222
22222222222222222222f2ff5555555555555555ff2f22222222f2ffffffffffffffffffff2f222222221cccccccccccccccccccccc122222222222222222222
22222222222222222222f2ff5555555555555555ff2f22222222f2ffffffffffffffffffff2f222222221cccccccccccccccccccccc122222222222222222222
22222222222222222222f2ff5555555555555555ff2f222ff222f2ffffffffffffffffffff2f222ff2221cccccccccccccccccccccc122222222222222222222
22222222222222222222f2fff55555555555555fff2f222ff222f2ffffffffffffffffffff2f222ff2221cccccccccccccccccccccc122222222222222222222
22222222222222222222f2ffffffffffffffffffff2f222ff222f2ffffffffffffffffffff2f222ff2221cccccccccccccccccccccc122222222222222222222
22222222222222222222f2ffffffffffffffffffff2f222ff222f2ffffffffffffffffffff2f222ff2221cccccccccccccccccccccc122222222222222222222
22222222222222222222f2ffffffffffffffffffff2f222ff222f2ffffffffffffffffffff2f222ff2221cccccccccccccccccccccc122222222222222222222
22222222222222222222f2ffffffffffffffffffff2f22222222f2ffffffffffffffffffff2f222222221cccccccccccccccccccccc122222222222222222222
22222222222222222222f2ffffffffffffffffffff2f22222222f2ffffffffffffffffffff2f222222221cccccccccccccccccccccc122222222222222222222
22222222222222222222f2ffffffffffffffffffff2f22222222f2ffffffffffffffffffff2f222222221cccccccccccccccccccccc122222222222222222222
22222222222222222222f2ffffffffffffffffffff2f222ff222f2ffffffffffffffffffff2f222ff2221cccccccccccccccccccccc122222222222222222222
22222222222222222222f2ffffffffffffffffffff2f222ff222f2ffffffffffffffffffff2f222ff2221cccccccccccccccccccccc122222222222222222222
22222222222222222222f2ffffffffffffffffffff2f222ff222f2ffffffffffffffffffff2f222ff22251111111111111111111111522222222222222222222
22222222222222222222f2ffffffffffffffffffff2f222ff222f2ffffffffffffffffffff2f222ff22255555555555555555555555522222222222222222222
22222222222222222222f2ffffffffffffffffffff2f222ff222f2ffffffffffffffffffff2f222ff22255555555555555555555555522222222222222222222
22222222222222222222f2ffffffffffffffffffff2f22222222f2ffffffffffffffffffff2f2222222255555555555555555555555522222222222222222222
22222222222222222222f2ffffffffffffffffffff2f22222222f2ffffffffffffffffffff2f22222222f5555555555555555555555f22222222222222222222
22222222222222222222f2ffffffffffffffffffff2f22222222f2ffffffffffffffffffff2f22222222f2ffffffffffffffffffffdf22222222222222222222
22222222222222222222f2ffffffffffffffffffff2f222ff222f2ffffffffffffffffffff2f222ff222f2ffffffffffffffffffffdf22222222222222222222
22222222222222222222f2ffffffffffffffffffff2f222ff222f2ffffffffffffffffffff2f222ff222f2ffffffffffffffffffffdf22222222222222222222
22222222222222222222f2ffffffffffffffffffff2f222ff222f2ffffffffffffffffffff2f222ff222f2ffffffffffffffffffffdf22222222222222222222
22222222222222222222f2ffffffffffffffffffff2f222ff222f2ffffffffffffffffffff2f222ff222f2ffffffffffffffffffffdf22222222222222222222
22222222222222222222f2ffffffffffffffffffff2f222ff222f2ffffffffffffffffffff2f222ff222f2ffffffffffffffffffffdf22222222222222222222
22222222222222222222f2ffffffffffffffffffff2f22222222f2ffffffffffffffffffff2f22222222f2ffffffffffffffffffffdf22222222222222222222
22222222222222222222f2ffffffffffffffffffff2f22222222f2ffffffffffffffffffff2f22222222f2ffffffffffffffffffffdf22222222222222222222
22222222222222222222f2ffffffffffffffffffff2f22222222f2ffffffffffffffffffff2f22222222f2ffffffffffffffffffffdf22222222222222222222
22222222222222222222f2ffffffffffffffffffff2f222ff222f2ffffffffffffffffffff2f222ff222f2ffffffffffffffffffffdf22222222222222222222
22222222222222222222f2ffffffffffffffffffff2f222ff222f2ffffffffffffffffffff2f222ff222f2ffffffffffffffffffffdf22222222222222222222
22222222222222222222f2ffffffffffffffffffff2f222ff222f2ffffffffffffffffffff2f222ff222f2ffffffffffffffffffffdf22222222222222222222
